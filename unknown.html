<html>
	<head>

		<script type="text/javascript" src="vis.js"></script>

		<style>

			body {
				background-color: #000;
			}

			canvas {
				display: block;
				margin: auto;
			}

		</style>

	</head>
	<body>

		<canvas id="testCanvas"></canvas>

	</body>

	<script>
		// sketch code goes here
		
		VIS.install();
		setCanvas(document.getElementById("testCanvas"));

		size(500, 620);

		lineCap("round");
		lineJoin("round");

		stroke(255);

		var margin = {
			top: 50
		};
		var rows = 30;
		var overlap = 3.5;
		var strWid = 3.5;
		strokeWidth(strWid);
		var spaceHeight = (height - margin.top) / rows;
		var maxPolyHeight = spaceHeight * overlap;
		var polySubdivisions = 100;

		function setup() {
			var poly;
			var subDivWidth = width / polySubdivisions;
			var polyY, polyX;
			var centerX = width / 2;
			var rand;
			for (var i = 0; i < rows; ++i) {
				poly = new Polygon();
				poly.vertex(-strWid, height + strWid);
				polyY = i * spaceHeight + margin.top;
				poly.vertex(0, polyY);
				for (var j = 1; j < polySubdivisions; ++j) {
					polyX = j * subDivWidth;
					rand = adjustedRandom(polyX) * scaleFactor(polyX);
					poly.vertex(polyX, polyY - rand);
				}
				poly.vertex(width, polyY);
				poly.vertex(width + strWid, height + strWid);
				
				poly.draw();
			}
		}

		function scaleFactor(x) {
			var frac = x / width;
			if (frac < 0.25) return 5;
			else if (frac < 0.45) return 15;
			else if (frac < 0.55) return 35;
			else if (frac < 0.75) return 15;
			else return 5;
		}

		function adjustedRandom(x) {
			var frac = x / width;
			if (frac < 0.25) return random();
			else if (frac < 0.45) return random() - 0.4;
			else if (frac < 0.55) return random();
			else if (frac < 0.75) return random() + 0.4;
			else return random();
		}

		function click(e) {
			clear();
			setup();
		}
		


	</script>
</html>